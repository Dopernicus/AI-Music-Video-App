name: Regenerate Wrapper

on:
  workflow_dispatch:

jobs:
  regen:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Remove old wrapper
        run: |
          rm -f gradle/wrapper/gradle-wrapper.jar
          rm -f gradlew
          rm -f gradlew.bat

      - name: Download Gradle
        run: |
          wget https://services.gradle.org/distributions/gradle-8.5-bin.zip -O gradle.zip
          unzip gradle.zip -d gradle_dist

      - name: Generate new wrapper
        run: |
          cd gradle_dist/gradle-8.5
          ./bin/gradle wrapper
          cp -r ./gradle/wrapper ../../gradle/
          cp ./gradlew ../../
          cp ./gradlew.bat ../../

      - name: Commit wrapper
        run: |
          git config --global user.email "actions@github.com"
          git config --global user.name "GitHub Actions"
          git add .
          git commit -m "Regenerate Gradle wrapper"
          git push
